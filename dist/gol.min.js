var l=l||{};
$(function(){(function(f,m){f.h=function(a,d){this.e=a;this.c=d;this.a=[];this.b={};this.add=function(b,c){var a=b+"_"+c,d=this.b[a];if(d)return null;d=new f.f(b,c);this.a.push(d);return this.b[a]=d};this.j=function(){for(var b=0,c=this.e*this.c*.05;b<c;)this.add(Math.round(this.e*Math.random()),Math.round(this.c*Math.random()))&&b++;return this};this.g=function(b){b.clearRect(0,0,b.canvas.width,b.canvas.height);b.fillStyle="#0000FF";for(var c=0;c<this.a.length;c++){var a=this.a[c];b.fillRect(a.x,a.y,
1,1)}return this};this.step=function(){var b,c,a,d,g,h={};for(b=0;b<this.a.length;b++){var e=this.a[b].k(this);for(c=0;c<e.length;c++)a=e[c],g=a.x+"_"+a.y,(d=h[g])?d.d++:(a.d=1,h[g]=a)}d=[];e={};for(b=0;b<this.a.length;b++)c=this.a[b],g=c.x+"_"+c.y,!(a=h[g])||2>a.d||3<a.d||(d.push(c),e[g]=c);this.a=d;this.b=e;h=f.l(h);for(b=0;b<h.length;b++)a=h[b],3===a.d&&(g=a.x+"_"+a.y,c=this.b[g],c||(c=new f.f(a.x,a.y),this.a.push(c),this.b[g]=c));return this};this.start=function(a,c,d){function e(){console.log(g);
f.step();f.g(d);g++>a||setTimeout(e,c)}var g=0,f=this;e();return this}};f.f=function(a,d){this.x=a;this.y=d};f.f.prototype.k=function(a){var d=0===this.x?a.e-1:this.x-1,b=this.x===a.e-1?0:this.x+1,c=0===this.y?a.c-1:this.y-1;a=this.y===a.c-1?0:this.y+1;return[{x:d,y:c},{x:d,y:this.y},{x:d,y:a},{x:this.x,y:c},{x:this.x,y:a},{x:b,y:c},{x:b,y:this.y},{x:b,y:a}]};f.i=function(a,d){if(d.offsetX&&d.offsetY)return{x:d.offsetX,y:d.offsetY};var b=0,c=0;do b+=a.offsetLeft-a.scrollLeft,c+=a.offsetTop-a.scrollTop;
while(a=a.offsetParent);return{x:d.pageX-b,y:d.pageY-c}};f.l=function(a){var d=[],b;for(b in a)a.hasOwnProperty(b)&&d.push(a[b]);return d};var e=m("#cdiv"),n=e.width(),e=e.height(),p=document.getElementById("canvas"),k=p.getContext("2d");k.canvas.width=n;k.canvas.height=e;m("#canvas").click(function(a){console.log(f.i(p,a))});(new f.h(n,e)).j().g(k).start(5E3,0,k)})(l,$)});
