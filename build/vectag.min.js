!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.vectag=e():t.vectag=e()}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="build/",n(n.s=1)}([function(t,e,n){t.exports=function(){"use strict";function t(t,r,i,o,a){!function t(n,r,i,o,a){for(;o>i;){if(o-i>600){var s=o-i+1,h=r-i+1,u=Math.log(s),l=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*l*(s-l)/s)*(h-s/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-h*l/s+f)),Math.min(o,Math.floor(r+(s-h)*l/s+f)),a)}var c=n[r],y=i,v=o;for(e(n,i,r),a(n[o],c)>0&&e(n,i,o);y<v;){for(e(n,y,v),y++,v--;a(n[y],c)<0;)y++;for(;a(n[v],c)>0;)v--}0===a(n[i],c)?e(n,i,v):e(n,++v,o),v<=r&&(i=v+1),r<=v&&(o=v-1)}}(t,r,i||0,o||t.length-1,a||n)}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,r,i){i||(i=v(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var a=t.children[o];s(i,t.leaf?r(a):a)}return i}function s(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function h(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function c(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function y(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function v(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function p(e,n,r,i,o){for(var a=[n,r];a.length;)if(!((r=a.pop())-(n=a.pop())<=i)){var s=n+Math.ceil((r-n)/i/2)*i;t(e,s,n,r,o),a.push(n,s,s,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!y(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],s=e.leaf?r(a):a;y(t,s)&&(e.leaf?n.push(a):c(t,s)?this._all(a,n):i.push(a))}e=i.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!y(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(y(t,o)){if(e.leaf||c(t,o))return!0;n.push(i)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=v([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,r,o,a=this.data,s=this.toBBox(t),h=[],u=[];a||h.length;){if(a||(a=h.pop(),r=h[h.length-1],n=u.pop(),o=!0),a.leaf){var l=i(t,a.children,e);if(-1!==l)return a.children.splice(l,1),h.push(a),this._condense(h),this}o||a.leaf||!c(a,s)?r?(n++,a=r.children[n],o=!1):a=null:(h.push(a),u.push(n),n=0,r=a,a=a.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,r){var i,a=n-e+1,s=this._maxEntries;if(a<=s)return o(i=v(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),(i=v([])).leaf=!1,i.height=r;var h=Math.ceil(a/s),u=h*Math.ceil(Math.sqrt(s));p(t,e,n,u,this.compareMinX);for(var l=e;l<=n;l+=u){var f=Math.min(l+u-1,n);p(t,l,f,h,this.compareMinY);for(var c=l;c<=f;c+=h){var y=Math.min(c+h-1,f);i.children.push(this._build(t,c,y,r-1))}}return o(i,this.toBBox),i},r.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,o=1/0,a=void 0,s=0;s<e.children.length;s++){var h=e.children[s],u=l(h),f=(c=t,y=h,(Math.max(y.maxX,c.maxX)-Math.min(y.minX,c.minX))*(Math.max(y.maxY,c.maxY)-Math.min(y.minY,c.minY))-u);f<o?(o=f,i=u<i?u:i,a=h):f===o&&u<i&&(i=u,a=h)}e=a||e.children[0]}var c,y;return e},r.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),s(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},r.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var a=this._chooseSplitIndex(n,i,r),s=v(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},r.prototype._splitRoot=function(t,e){this.data=v([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var r,i,o,s,h,u,f,c=1/0,y=1/0,v=e;v<=n-e;v++){var p=a(t,0,v,this.toBBox),d=a(t,v,n,this.toBBox),m=(i=p,o=d,s=Math.max(i.minX,o.minX),h=Math.max(i.minY,o.minY),u=Math.min(i.maxX,o.maxX),f=Math.min(i.maxY,o.maxY),Math.max(0,u-s)*Math.max(0,f-h)),g=l(p)+l(d);m<c?(c=m,r=v,y=g<y?g:y):m===c&&g<y&&(y=g,r=v)}return r||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:h,i=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=a(t,0,e,i),h=a(t,n-e,n,i),u=f(o)+f(h),l=e;l<n-e;l++){var c=t.children[l];s(o,t.leaf?i(c):c),u+=f(o)}for(var y=n-e-1;y>=e;y--){var v=t.children[y];s(h,t.leaf?i(v):v),u+=f(h)}return u},r.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)s(e[r],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},r}()},function(t,e,n){t.exports=n(2)},function(t,e,n){"use strict";function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,h=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){h=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(h)throw a}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.r(e),n.d(e,"planets",(function(){return V})),n.d(e,"gameOfLife",(function(){return J})),n.d(e,"fish",(function(){return mt})),n.d(e,"preyPredator",(function(){return Yt}));var o=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.indexOf(e);r>-1?t.splice(r,1):n&&console.log("Impossible to remove element not present in array.")},a=function(t,e){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=r(e);try{for(a.s();!(n=a.n()).done;){var s=n.value;o(t,s,i)}}catch(t){a.e(t)}finally{a.f()}},s=n(0),h=n.n(s);function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y(t);if(e){var i=y(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),t}var m=function(){function t(){v(this,t);var e=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(n,t);var e=f(n);function n(){return v(this,n),e.apply(this,arguments)}return d(n,[{key:"toBBox",value:function(t){return{minX:t.x,minY:t.y,maxX:t.x,maxY:t.y}}},{key:"compareMinX",value:function(t,e){return t.x-e.x}},{key:"compareMinY",value:function(t,e){return t.y-e.y}}]),n}(h.a);this.tree=new e}return d(t,[{key:"get",value:function(t,e,n,r){return this.tree.search({minX:t,minY:e,maxX:n,maxY:r})}},{key:"insert",value:function(t){this.tree.insert(t)}},{key:"load",value:function(t){this.tree.load(t)}},{key:"remove",value:function(t){this.tree.remove(t)}},{key:"clear",value:function(){this.tree.clear()}}]),t}();function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var x=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"vacanvas",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;g(this,t),this.canvas=document.getElementById(n),this.w=this.canvas.offsetWidth,this.h=this.canvas.offsetHeight,this.canvas.width=this.w,this.canvas.height=this.h,this.ctx=this.canvas.getContext("2d"),this.setCenter(r||{x:.5*this.w,y:.5*this.h}),this.setZf(i),this.extGeo=void 0,this.updateExtentGeo();var o=!1;this.canvas.addEventListener("mousedown",(function(t){o=!0})),this.canvas.addEventListener("mousemove",(function(t){o&&e.pan(-t.movementX*e.getZf(),t.movementY*e.getZf())})),this.canvas.addEventListener("mouseup",(function(t){o=!1}));var a=1.5;this.canvas.addEventListener("wheel",(function(t){var n=t.deltaY>0?a:1/a;e.zoom(n,e.pixToGeoX(t.offsetX),e.pixToGeoY(t.offsetY))}))}var e,n,r;return e=t,(n=[{key:"setCenter",value:function(t){this.center=t}},{key:"getCenter",value:function(){return this.center}},{key:"setZf",value:function(t){this.zf=t}},{key:"getZf",value:function(){return this.zf}},{key:"initCanvasTransform",value:function(){this.ctx.setTransform(1,0,0,1,0,0)}},{key:"setCanvasTransform",value:function(){var t=1/this.getZf(),e=-this.center.x/this.getZf()+.5*this.w,n=this.center.y/this.getZf()+.5*this.h;this.ctx.setTransform(t,0,0,-t,e,n)}},{key:"redraw",value:function(){throw new Error("Method redraw not implemented.")}},{key:"clear",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"white";this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.w,this.h)}},{key:"geoToPixX",value:function(t){return(t-this.center.x)/this.getZf()+.5*this.w}},{key:"geoToPixY",value:function(t){return-(t-this.center.y)/this.getZf()+.5*this.h}},{key:"pixToGeoX",value:function(t){return(t-.5*this.w)*this.getZf()+this.center.x}},{key:"pixToGeoY",value:function(t){return-(t-.5*this.h)*this.getZf()+this.center.y}},{key:"pan",value:function(t,e){this.center.x+=t,this.center.y+=e,this.updateExtentGeo(),this.redraw()}},{key:"zoom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.center.x,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.center.y;this.setZf(t*this.getZf()),this.center.x+=(e-this.center.x)*(1-t),this.center.y+=(n-this.center.y)*(1-t),this.updateExtentGeo(),this.redraw()}},{key:"updateExtentGeo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return this.extGeo={xMin:this.pixToGeoX(-t),xMax:this.pixToGeoX(this.w+t),yMin:this.pixToGeoY(this.h+t),yMax:this.pixToGeoY(-t)},this.extGeo}},{key:"toDraw",value:function(t){return!(t.x<this.extGeo.xMin||t.x>this.extGeo.xMax||t.y<this.extGeo.yMin||t.y>this.extGeo.yMax)}}])&&b(e.prototype,n),r&&b(e,r),t}();function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var S=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;w(this,t),this.x=e,this.y=n,this.sx=r,this.sy=i,this.s=void 0,this.sa=void 0}var e,n,r;return e=t,(n=[{key:"d",value:function(t){return this.dP(t.x,t.y)}},{key:"dP",value:function(t,e){return Math.hypot(t-this.x,e-this.y)}},{key:"setRandomSpeed",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;this.s=t+Math.random()*(e-t),this.sa=2*Math.random()*Math.PI,this.sx=this.s*Math.cos(this.sa),this.sy=this.s*Math.sin(this.sa)}},{key:"computeSpeed",value:function(){return this.s=Math.hypot(this.sx,this.sy),this.s}},{key:"computeSpeedAngle",value:function(){return this.sa=Math.atan2(this.sy,this.sx),this.sa}}])&&M(e.prototype,n),r&&M(e,r),t}();function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function P(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=I(t);if(e){var i=I(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return T(this,n)}}function T(t,e){return!e||"object"!==k(e)&&"function"!=typeof e?j(t):e}function j(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var E=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(o,t);var e,n,r,i=P(o);function o(t,e,n,r){var a,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;_(this,o),(a=i.call(this,n,r,s,h)).u=t,t.ps.push(j(a)),a.m=e;var u=a.r();return a.x=n<u?u:n>t.w-u?t.w-u:n,a.y=r<u?u:r>t.h-u?t.h-u:r,a.ax=0,a.ay=0,a}return e=o,(n=[{key:"observe",value:function(t){var e=this.u.getGravityField(this.x,this.y,this,t);this.ax=e.gx,this.ay=e.gy}},{key:"r",value:function(){return Math.pow(this.m/Math.PI,.5)}},{key:"change",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;if(this.sx+=this.ax*n,this.sy+=this.ay*n,e>0){var r=Math.sqrt(this.sx*this.sx+this.sy*this.sy);r>e&&(this.sx=e*this.sx/r,this.sy=e*this.sy/r)}var i=this.x+this.sx*n,o=this.y+this.sy*n;if(t){var a=this.r(),s=1;i<a&&(i=a,this.sx=-this.sx*s),o<a&&(o=a,this.sy=-this.sy*s),i>this.u.w-a&&(i=this.u.w-a,this.sx=-this.sx*s),o>this.u.h-a&&(o=this.u.h-a,this.sy=-this.sy*s)}else i<0&&(i=this.u.w),o<0&&(o=this.u.h),i>this.u.w&&(i=0),o>this.u.h&&(o=0);this.x=i,this.y=o}},{key:"display",value:function(t,e){var n=t.ctx;n.fillStyle=e,n.beginPath(),n.arc(this.x,this.y,this.r()/t.getZf(),0,2*Math.PI),n.closePath(),n.fill()}},{key:"displayAcceleration",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"cyan",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3,i=t.ctx;i.strokeStyle=e,i.lineWidth=n,i.beginPath(),i.moveTo(this.x,this.y),i.lineTo(this.x+r*this.ax,this.y+r*this.ay),i.closePath(),i.stroke()}}])&&A(e.prototype,n),r&&A(e,r),o}(S);function X(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return R(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function B(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var C=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.w=e,this.h=n,this.ps=[]}var e,n,r;return e=t,(n=[{key:"m",value:function(){var t,e=0,n=X(this.ps);try{for(n.s();!(t=n.n()).done;)e+=t.value.m}catch(t){n.e(t)}finally{n.f()}return e}},{key:"getGravityField",value:function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,o=0,a=0,s=X(this.ps);try{for(s.s();!(n=s.n()).done;){var h=n.value;if(!r||h!=r){var u=h.dP(t,e);0!==u&&(u*=Math.pow(u,i),o+=.01*(h.x-t)*h.m/u,a+=.01*(h.y-e)*h.m/u)}}}catch(t){s.e(t)}finally{s.f()}return{gx:o,gy:a}}},{key:"aggregate",value:function(t,e,n){var r=t.m+e.m,i=new E(this,r,(t.x*t.m+e.x*e.m)/r,(t.y*t.m+e.y*e.m)/r,(t.sx*t.m+e.sx*e.m)/r,(t.sy*t.m+e.sy*e.m)/r);return o(this.ps,t),o(this.ps,e),n&&(n.remove(t),n.remove(e),n.insert(i)),i}},{key:"findCollision",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=X(this.ps);try{for(r.s();!(e=r.n()).done;){var i,o=e.value,a=2*o.r(),s=t.get(o.x-a,o.y-a,o.x+a,o.y+a),h=X(s);try{for(h.s();!(i=h.n()).done;){var u=i.value;if(o!=u){var l=o.d(u),f=(o.r()+u.r())*n;if(!(l>f))return[o,u]}}}catch(t){h.e(t)}finally{h.f()}}}catch(t){r.e(t)}finally{r.f()}return null}},{key:"addPlanets",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1,i=0;i<t;i++){var o=new E(this,e,this.w*Math.random(),this.h*Math.random());o.setRandomSpeed(n,r)}return this}},{key:"step",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,a=X(this.ps);try{for(a.s();!(t=a.n()).done;){var s=t.value;s.observe(r)}}catch(t){a.e(t)}finally{a.f()}var h,u=X(this.ps);try{for(u.s();!(h=u.n()).done;){var l=h.value;l.change(e,n,o)}}catch(t){u.e(t)}finally{u.f()}return this.detectCollisions(i),this}},{key:"detectCollisions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=new m;e.load(this.ps);for(var n=this.findCollision(e,t);null!==n;)this.aggregate(n[0],n[1],e),n=this.findCollision(e,t);return this}},{key:"setRandomSpeed",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,r=X(this.ps);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.setRandomSpeed(e,n)}}catch(t){r.e(t)}finally{r.f()}return this}},{key:"getLargestPlanet",value:function(){var t,e=null,n=0,r=X(this.ps);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.m>n&&(e=i,n=i.m)}}catch(t){r.e(t)}finally{r.f()}return e}},{key:"explodeLargestPlanet",value:function(){var t=this.getLargestPlanet();this.explode(t)}},{key:"explode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1;if(e<=0&&(e=Math.floor(t.m)),!(e<=0)){for(var a=2*Math.PI/e,s=0;s<e;s++){i<0&&(i=2*t.r());var h=i*Math.random(),u=s*a,l=h*Math.cos(u),f=h*Math.sin(u),c=n+Math.random()*(r-n),y=u+2*(Math.random()-.5)*2*Math.PI/3,v=c*Math.cos(y),p=c*Math.sin(y);new E(this,t.m/e,t.x+l,t.y+f,t.sx+v,t.sy+p)}o(this.ps,t)}}}])&&B(e.prototype,n),r&&B(e,r),t}();function Y(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return G(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function G(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function F(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var D=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(e=e||{}).canvasId=e.canvasId||"vacanvas";var n=document.getElementById(e.canvasId);this.w=e.w||n.offsetWidth,this.h=e.h||n.offsetHeight,this.maxSpeed=e.maxSpeed||.8,this.bounce=e.bounce||!1,this.exponent=e.exponent||2,this.collisionFactor=e.collisionFactor||1,this.showPlanetAcceleration=!1,this.showField=void 0,this.fieldRes=20,this.fieldFactor=1e3,this.fieldStrokeStyle="#99bbff",this.tailings=e.tailings||.1,this.cplus=new x,this.cplus.ctx.fillStyle="black",this.cplus.ctx.fillRect(0,0,this.w,this.h);var r=this;this.cplus.redraw=function(){var t=this.ctx;this.initCanvasTransform(),t.fillStyle="rgba(0,0,0,"+r.tailings+")",t.fillRect(0,0,r.w,r.h),"f"===r.showField?r.displayGravityField(this,!0):"i"===r.showField&&r.displayGravityField(this,!1),this.setCanvasTransform();var e,n=Y(r.uni.ps);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(this.toDraw(i)){var o=i.m/r.uni.m();i.display(this,"rgb(255,255,"+Math.floor(255*(1-o))+")")}}}catch(t){n.e(t)}finally{n.f()}if(r.showPlanetAcceleration){var a,s=Y(r.uni.ps);try{for(s.s();!(a=s.n()).done;){var h=a.value;this.toDraw(h)&&h.displayAcceleration(this)}}catch(t){s.e(t)}finally{s.f()}}return t.strokeStyle="darkgray",t.lineWidth=1*r.cplus.getZf(),t.beginPath(),t.rect(0,0,r.w,r.h),t.stroke(),this},this.uni=new C(this.w,this.h)}var e,n,r;return e=t,(n=[{key:"displayGravityField",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.ctx,r=this.fieldRes,i=this.fieldFactor,o=e?.3*r:.6*r;n.strokeStyle=this.fieldStrokeStyle;for(var a=.5*r;a<this.w;a+=r){var s=t.pixToGeoX(a);if(!(s>this.uni.w||s<0))for(var h=r/2;h<this.h;h+=r){var u=t.pixToGeoY(h);if(!(u>this.uni.h||u<0)){var l=this.uni.getGravityField(s,u,void 0,this.exponent),f=Math.hypot(l.gx,l.gy);n.lineWidth=Math.min(i*f,.3*r);var c=o*l.gx/f,y=o*l.gy/f;n.beginPath(),e?(n.moveTo(a-c,h+y),n.lineTo(a+c,h-y)):(n.moveTo(a+y,h+c),n.lineTo(a-y,h-c)),n.closePath(),n.stroke()}}}}},{key:"initRandom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1;return this.uni.ps=[],this.uni.addPlanets(t,e,n,r),this}},{key:"initBigBang",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.35,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.7,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;this.uni.ps=[];var o=.5*this.w,a=.5*this.h,s=new E(this.uni,t*e,o,a,0,0);return this.uni.explode(s,t,n,r,i),this}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=0,r=this,i=function i(){r.uni.step(r.bounce,r.maxSpeed,r.exponent,r.collisionFactor,t),r.cplus.redraw(),e>0&&n++>e||setTimeout(i,0)};return i(),this}},{key:"stop",value:function(){}}])&&F(e.prototype,n),r&&F(e,r),t}(),V=function(t){return new D(t)};function Z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var L=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Z(this,t),this.x=e,this.y=n,this.nb=r};function W(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return H(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function H(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.w=e,this.h=n,this.population=[],this.populationI={}}var e,n,r;return e=t,r=[{key:"getCellSurrounding",value:function(t,e){var n=0===t.x?e.w-1:t.x-1,r=t.x===e.w-1?0:t.x+1,i=0===t.y?e.h-1:t.y-1,o=t.y===e.h-1?0:t.y+1;return[new L(n,i),new L(n,t.y),new L(n,o),new L(t.x,i),new L(t.x,o),new L(r,i),new L(r,t.y),new L(r,o)]}}],(n=[{key:"add",value:function(t,e){var n=t+"_"+e;if(this.populationI[n])return null;var r=new L(t,e,0);return this.population.push(r),this.populationI[n]=r,r}},{key:"step",value:function(){var e,n={},r=W(this.population);try{for(r.s();!(e=r.n()).done;){var i,o=e.value,a=W(t.getCellSurrounding(o,this));try{for(a.s();!(i=a.n()).done;){var s=i.value,h=s.x+"_"+s.y,u=n[h];u?u.nb++:(s.nb=1,n[h]=s)}}catch(t){a.e(t)}finally{a.f()}}}catch(t){r.e(t)}finally{r.f()}var l,f=[],c={},y=W(this.population);try{for(y.s();!(l=y.n()).done;){var v=l.value,p=v.x+"_"+v.y,d=n[p];d&&(d.nb<2||d.nb>3||(f.push(v),c[p]=v))}}catch(t){y.e(t)}finally{y.f()}this.population=f,this.populationI=c;var m,g=W(function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(t[n]);return e}(n));try{for(g.s();!(m=g.n()).done;){var b=m.value;if(3===b.nb){var x=b.x+"_"+b.y;this.populationI[x]||(this.population.push(b),this.populationI[x]=b)}}}catch(t){g.e(t)}finally{g.f()}return this}},{key:"start",value:function(t,e,n){var r=0,i=this;return function o(){i.step(),n.redraw(),t>0&&r++>t||setTimeout(o,e)}(),this}}])&&U(e.prototype,n),r&&U(e,r),t}();function N(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return K(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function K(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var z=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(e=e||{}).canvasId=e.canvasId||"vacanvas";var n=document.getElementById(e.canvasId);this.w=e.w||n.offsetWidth,this.h=e.h||n.offsetHeight,this.cplus=new x;var r=this;this.cplus.redraw=function(){var t=this.ctx;this.initCanvasTransform(),t.fillStyle="white",t.fillRect(0,0,r.w,r.h),this.setCanvasTransform(),t.fillStyle="blue";var e,n=N(r.uni.population);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.fillRect(i.x,i.y,1,1)}}catch(t){n.e(t)}finally{n.f()}return t.strokeStyle="darkgray",t.lineWidth=1*r.cplus.getZf(),t.beginPath(),t.rect(0,0,r.w,r.h),t.stroke(),this},this.uni=new $(this.w,this.h)}var e,n,r;return e=t,(n=[{key:"initRandom",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.05,e=0,n=this.uni.w*this.uni.h*t;e<n;){var r=Math.round(this.uni.w*Math.random()),i=Math.round(this.uni.h*Math.random()),o=this.uni.add(r,i);o&&e++}return this}},{key:"start",value:function(){return this.uni.start(-1,0,this.cplus),this}}])&&q(e.prototype,n),r&&q(e,r),t}(),J=function(t){return new z(t)};function Q(t){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return et(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return et(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function nt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function it(t,e){return(it=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=st(t);if(e){var i=st(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return at(this,n)}}function at(t,e){return!e||"object"!==Q(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function st(t){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ht=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&it(t,e)}(o,t);var e,n,r,i=ot(o);function o(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.w*Math.random(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.h*Math.random(),a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;return nt(this,o),(e=i.call(this,n,r,a,s)).sea=t,e.x=n<0?0:n>t.w?t.w:n,e.y=r<0?0:r>t.h?t.h:r,a||s||(e.setRandomSpeed(0,e.sea.V_MAX),e.ax=0,e.ay=0,e.obs=[],e.col=[]),e}return e=o,(n=[{key:"observe",value:function(t){var e=this.sea,n=e.D_OBS;this.obs=[],this.col=[];var r,i=tt(t.get(this.x-n,this.y-n,this.x+n,this.y+n));try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o!=this&&(this.d(o)<=e.D_COL&&this.col.push(o),this.d(o)<=n)){var a=Math.atan2(o.y-this.y,o.x-this.x)-this.sa;if(a>Math.PI?a-=2*Math.PI:a<=-Math.PI&&(a+=2*Math.PI),(a=Math.abs(a))>.5*e.A_OBS)continue;this.obs.push(o)}}}catch(t){i.e(t)}finally{i.f()}this.ax=0,this.ay=0;var s,h=tt(this.col);try{for(h.s();!(s=h.n()).done;){var u=s.value,l=this.d(u),f=1*(1/(l*l)-1/(e.D_COL*e.D_COL));this.ax+=f*(this.x-u.x)/l,this.ay+=f*(this.y-u.y)/l}}catch(t){h.e(t)}finally{h.f()}var c=.01*(e.V_TARGET-this.s);this.ax+=c*this.sx/this.s,this.ay+=c*this.sy/this.s;var y=.9;if(this.obs.length>1){var v,p=0,d=0,m=tt(this.obs);try{for(m.s();!(v=m.n()).done;){var g=v.value;p+=g.sx,d+=g.sy}}catch(t){m.e(t)}finally{m.f()}p=(y-1)*this.sx+(1-y)*p/this.obs.length,d=(y-1)*this.sy+(1-y)*d/this.obs.length,this.ax+=.1*p,this.ay+=.1*d}var b=e.shark;if(null!=b){var x=Math.hypot(b.x-this.x,b.y-this.y);if(x<=e.D_OBS){var w=5*(1/(x*x)-1/(n*n));this.ax+=w*(this.x-b.x)/x,this.ay+=w*(this.y-b.y)/x}}}},{key:"move",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this.sx+=this.ax*t+.02*(1-2*Math.random()),this.sy+=this.ay*t+.02*(1-2*Math.random()),this.s=this.computeSpeed(),this.s>this.sea.V_MAX&&(this.s=this.sea.V_MAX,this.sx=this.sea.V_MAX*Math.cos(this.sa),this.sy=this.sea.V_MAX*Math.sin(this.sa)),this.x+=this.sx*t,this.y+=this.sy*t,this.x<0&&(this.x=this.sea.w),this.y<0&&(this.y=this.sea.h),this.x>this.sea.w&&(this.x=0),this.y>this.sea.h&&(this.y=0)}},{key:"display",value:function(t,e){var n=t.ctx,r=Math.floor(255*Math.abs(this.sa)/Math.PI);n.strokeStyle="rgb(255, 255, "+r+")";var i=e/this.s,o=i*this.sx*.5,a=i*this.sy*.5;n.beginPath(),n.moveTo(this.x-o,this.y-a),n.lineTo(this.x+o,this.y+a),n.closePath(),n.stroke()}},{key:"displayVisionField",value:function(t,e,n){var r=t.ctx;r.fillStyle=e,r.lineWidth=n,r.beginPath(),r.moveTo(this.x,this.y),r.arc(this.x,this.y,this.sea.D_OBS/t.getZf(),this.sa-.5*this.sea.A_OBS,this.sa+.5*this.sea.A_OBS),r.closePath(),r.fill()}},{key:"displayVisionLinks",value:function(t,e,n){var r=t.ctx;r.strokeStyle=e,r.lineWidth=n;var i,o=tt(this.obs);try{for(o.s();!(i=o.n()).done;){var a=i.value;r.beginPath(),r.moveTo(this.x,this.y),r.lineTo(a.x,a.y),r.closePath(),r.stroke()}}catch(t){o.e(t)}finally{o.f()}}},{key:"displayCollisionField",value:function(t,e,n){var r=t.ctx;r.strokeStyle=e,r.lineWidth=n,r.beginPath(),r.arc(this.x,this.y,.5*this.sea.D_COL/t.getZf(),0,2*Math.PI),r.closePath(),r.stroke()}}])&&rt(e.prototype,n),r&&rt(e,r),o}(S);function ut(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return lt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ct=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.D_OBS=50,this.A_OBS=200*Math.PI/180,this.D_COL=10,this.V_TARGET=.3,this.V_MAX=.6,this.D_SHARK_EAT=12,this.EATEN_SARDIN_NB=0,this.w=e,this.h=n,this.fish=[],this.shark=null,this.killed=[]}var e,n,r;return e=t,(n=[{key:"step",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=ut(this.fish);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.computeSpeed(),r.computeSpeedAngle()}}catch(t){n.e(t)}finally{n.f()}var i=new m;i.load(this.fish);var o,a=ut(this.fish);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.observe(i)}}catch(t){a.e(t)}finally{a.f()}this.sharkEat(i);var h,u=ut(this.fish);try{for(u.s();!(h=u.n()).done;){var l=h.value;l.move(e)}}catch(t){u.e(t)}finally{u.f()}}},{key:"sharkEat",value:function(t){if(null!=this.shark){this.killed=[];var e,n=this.shark.x,r=this.shark.y,i=ut(t.get(n-this.D_SHARK_EAT,r-this.D_SHARK_EAT,n+this.D_SHARK_EAT,r+this.D_SHARK_EAT));try{for(i.s();!(e=i.n()).done;){var a=e.value;Math.hypot(n-a.x,r-a.y)>this.D_SHARK_EAT||(this.killed.push(a),o(this.fish,a))}}catch(t){i.e(t)}finally{i.f()}return this.EATEN_SARDIN_NB+=this.killed.length,this}}},{key:"addFish",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=0;e<t;e++)this.fish.push(new ht(this));return this}},{key:"setRandomSpeed",value:function(){var t,e=ut(this.fish);try{for(e.s();!(t=e.n()).done;)t.value.setRandomSpeed()}catch(t){e.e(t)}finally{e.f()}return this}}])&&ft(e.prototype,n),r&&ft(e,r),t}();function yt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return vt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function vt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var dt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(e=e||{}).canvasId=e.canvasId||"vacanvas";var n=document.getElementById(e.canvasId);this.w=e.w||n.offsetWidth,this.h=e.h||n.offsetHeight,this.cplus=new x,this.cplus.ctx.fillStyle="black",this.cplus.ctx.fillRect(0,0,this.w,this.h),this.showFishVisionField=!1,this.showFishVisionLinks=!1,this.showFishCollisionField=!1;var r=this;this.cplus.redraw=function(){var t=this.ctx,e=r.sea;if(this.initCanvasTransform(),t.fillStyle="rgba(120,120,255,0.6)",t.fillRect(0,0,r.w,r.h),this.setCanvasTransform(),r.showFishVisionField){var n,i=yt(e.fish);try{for(i.s();!(n=i.n()).done;){var o=n.value;this.toDraw(o)&&o.displayVisionField(this,"rgba(200,200,200,0.15)",1)}}catch(t){i.e(t)}finally{i.f()}}if(r.showFishVisionLinks){var a,s=yt(e.fish);try{for(s.s();!(a=s.n()).done;){var h=a.value;this.toDraw(h)&&h.displayVisionLinks(this,"rgba(255,100,100,0.3)",1)}}catch(t){s.e(t)}finally{s.f()}}if(r.showFishCollisionField){var u,l=yt(e.fish);try{for(l.s();!(u=l.n()).done;){var f=u.value;this.toDraw(f)&&f.displayCollisionField(this,"purple",1)}}catch(t){l.e(t)}finally{l.f()}}t.lineWidth=2;var c,y=yt(e.fish);try{for(y.s();!(c=y.n()).done;){var v=c.value;this.toDraw(v)&&v.display(this,7)}}catch(t){y.e(t)}finally{y.f()}if(null!=e.shark){t.lineWidth=4,t.strokeStyle="black";var p=12*Math.cos(e.shark.angle),d=12*Math.sin(e.shark.angle);t.beginPath(),t.moveTo(e.shark.x,e.shark.y),t.lineTo(e.shark.x-p,e.shark.y+d),t.closePath(),t.stroke()}t.fillStyle="red",t.lineWidth=1;var m,g=yt(e.killed);try{for(g.s();!(m=g.n()).done;){var b=m.value;t.beginPath(),t.moveTo(b.x,b.y),t.arc(b.x,b.y,4,0,2*Math.PI),t.closePath(),t.fill()}}catch(t){g.e(t)}finally{g.f()}return t.strokeStyle="darkgray",t.lineWidth=1*r.cplus.getZf(),t.beginPath(),t.rect(0,0,r.w,r.h),t.stroke(),this},this.cplus.canvas.addEventListener("mouseover",(function(t){r.sea.shark={x:r.cplus.pixToGeoX(t.offsetX),y:r.cplus.pixToGeoY(t.offsetY),angle:0}})),this.cplus.canvas.addEventListener("mousemove",(function(t){var e=r.cplus.pixToGeoX(t.offsetX),n=r.cplus.pixToGeoY(t.offsetY),i=Math.atan2(-n+r.sea.shark.y,e-r.sea.shark.x);r.sea.shark={x:e,y:n,angle:i}})),this.cplus.canvas.addEventListener("mouseout",(function(t){r.sea.shark=null})),this.sea=new ct(this.w,this.h)}var e,n,r;return e=t,(n=[{key:"initRandom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001;return this.sea.addFish(t*this.sea.w*this.sea.h),this}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=0,r=this,i=function i(){r.sea.step(t),r.cplus.redraw(),e>0&&n++>e||setTimeout(i,0)};return i(),this}}])&&pt(e.prototype,n),r&&pt(e,r),t}(),mt=function(t){return new dt(t)};function gt(t){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return xt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function wt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function St(t,e){return(St=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ot(t);if(e){var i=Ot(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _t(this,n)}}function _t(t,e){return!e||"object"!==gt(e)&&"function"!=typeof e?At(t):e}function At(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ot(t){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Pt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&St(t,e)}(o,t);var e,n,r,i=kt(o);function o(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return wt(this,o),(n=i.call(this,r,a)).type=t,n.l=e,n.x=r<0?0:r>e.w?e.w:r,n.y=a<0?0:a>e.h?e.h:a,n.predators=[],n.preys=[],e.grid.insert(At(n)),n}return e=o,(n=[{key:"move",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this.l;e.grid.remove(this);var n=2*Math.random()*Math.PI,r=.01*Math.random();this.sx+=r*Math.cos(n)*t,this.sx=this.sx>e.V_MAX?e.V_MAX:this.sx<-e.V_MAX?-e.V_MAX:this.sx,this.sy+=r*Math.sin(n)*t,this.sy=this.sy>e.V_MAX?e.V_MAX:this.sy<-e.V_MAX?-e.V_MAX:this.sy,this.x+=this.sx*t,this.x=this.x<0?e.w:this.x>e.w?0:this.x,this.y+=this.sy*t,this.y=this.y<0?e.h:this.y>e.h?0:this.y,e.grid.insert(this)}},{key:"observe",value:function(){var t=this.l,e=t.grid.get(this.x-t.d,this.y-t.d,this.x+t.d,this.y+t.d);this.preys=[],this.predators=[];var n,r=bt(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;i!=this&&(this.d(i)>t.d||(0==i.type?this.preys.push(i):this.predators.push(i)))}}catch(t){r.e(t)}finally{r.f()}}},{key:"makeChild",value:function(){return new o(this.type,this.l,this.x,this.y)}},{key:"display",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blue",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;t.ctx.fillStyle=e,t.ctx.fillRect(this.x,this.y,n,n)}}])&&Mt(e.prototype,n),r&&Mt(e,r),o}(S);function Tt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return jt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function jt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function It(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Et=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.V_MAX=.1,this.p=.02,this.q=.1,this.r=.5,this.nb=3,this.w=e,this.h=n,this.predators=[],this.preys=[],this.d=10,this.grid=new m}var e,n,r;return e=t,(n=[{key:"step",value:function(){var t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,i=Tt(this.preys);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.observe()}}catch(t){i.e(t)}finally{i.f()}var s,h=Tt(this.predators);try{for(h.s();!(s=h.n()).done;){var u=s.value;u.observe()}}catch(t){h.e(t)}finally{h.f()}var l,f=[],c=[],y=[],v=[],p=Tt(this.preys);try{for(p.s();!(l=p.n()).done;){var d=l.value;Math.random()>this.q||0==d.predators.length&&(d.preys.length>=this.nb||f.push(d.makeChild()))}}catch(t){p.e(t)}finally{p.f()}var m,g=Tt(this.predators);try{for(g.s();!(m=g.n()).done;){var b=m.value;if(0==b.preys.length)Math.random()<this.p&&v.push(b);else{var x=b.preys[Math.floor(b.preys.length*Math.random())];if(c.push(x),Math.random()>this.r)continue;if(b.predators.length>=this.nb)continue;y.push(b.makeChild())}}}catch(t){g.e(t)}finally{g.f()}(t=this.preys).push.apply(t,f),(e=this.predators).push.apply(e,y),a(this.preys,c,!1);for(var w=0,M=c;w<M.length;w++){var S=M[w];this.grid.remove(S)}a(this.predators,v,!1);for(var k=0,_=v;k<_.length;k++){var A=_[k];this.grid.remove(A)}var O,P=Tt(this.preys);try{for(P.s();!(O=P.n()).done;){var T=O.value;T.move(r)}}catch(t){P.e(t)}finally{P.f()}var j,I=Tt(this.predators);try{for(I.s();!(j=I.n()).done;){var E=j.value;E.move(r)}}catch(t){I.e(t)}finally{I.f()}}}])&&It(e.prototype,n),r&&It(e,r),t}();function Xt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Rt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rt(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Ct=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(e=e||{}).canvasId=e.canvasId||"vacanvas";var n=document.getElementById(e.canvasId);this.w=e.w||n.offsetWidth,this.h=e.h||n.offsetHeight,this.cplus=new x,this.cplus.ctx.fillStyle="white",this.cplus.ctx.fillRect(0,0,this.w,this.h);var r=this;this.cplus.redraw=function(){var t=this.ctx;this.initCanvasTransform(),t.fillStyle="rgba(255,255,255,0.5)",t.fillRect(0,0,r.w,r.h),this.setCanvasTransform();var e,n=Xt(r.land.preys);try{for(n.s();!(e=n.n()).done;){var i=e.value;this.toDraw(i)&&i.display(this,"blue")}}catch(t){n.e(t)}finally{n.f()}var o,a=Xt(r.land.predators);try{for(a.s();!(o=a.n()).done;){var s=o.value;this.toDraw(s)&&s.display(this,"red")}}catch(t){a.e(t)}finally{a.f()}return t.strokeStyle="darkgray",t.lineWidth=1*r.cplus.getZf(),t.beginPath(),t.rect(0,0,r.w,r.h),t.stroke(),this},this.land=new Et(this.w,this.h)}var e,n,r;return e=t,(n=[{key:"initRandom",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.003,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.003,n=this.land,r=0;r<t*n.w*n.h;r++)n.preys.push(new Pt(0,n,n.w*Math.random(),n.h*Math.random()));for(var i=0;i<e*n.w*n.h;i++)n.predators.push(new Pt(1,n,n.w*Math.random(),n.h*Math.random()));return this}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=0,r=this,i=function i(){r.land.step(t),r.cplus.redraw(),e>0&&n++>e||setTimeout(i,0)};return i(),this}}])&&Bt(e.prototype,n),r&&Bt(e,r),t}(),Yt=function(t){return new Ct(t)}}])}));