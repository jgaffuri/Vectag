!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.vectag=e():t.vectag=e()}(window,(function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(i,s,function(e){return t[e]}.bind(null,s));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="build/",r(r.s=0)}([function(t,e,r){t.exports=r(1)},function(t,e,r){"use strict";r.r(e),r.d(e,"objToArray",(function(){return i})),r.d(e,"removeFromArray",(function(){return s})),r.d(e,"Grid",(function(){return n})),r.d(e,"CanvasPlus",(function(){return o})),r.d(e,"planets",(function(){return f}));var i=function(t){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(t[r]);return e},s=function(t,e){var r=t.indexOf(e);r>-1?t.splice(r,1):console.log("Impossible to remove element not present in array.")},n=function(t,e,r){this.res=r,this.lengthX=Math.floor(t/r+1),this.lengthY=Math.floor(e/r+1),this.cells=[];for(var i=0;i<this.lengthX;i++){this.cells[i]=[];for(var s=0;s<this.lengthY;s++)this.cells[i][s]=[]}};n.prototype.get=function(t,e,r,i){for(var s=[],n=Math.floor(t/this.res);n<Math.floor(r/this.res+1);n++)if(!(n<0||n>=this.lengthX))for(var o=Math.floor(e/this.res);o<Math.floor(i/this.res+1);o++)o<0||o>=this.lengthY||s.push.apply(s,this.cells[n][o]);return s},n.prototype.add=function(t,e,r){return this.cells[Math.floor(e/this.res)][Math.floor(r/this.res)].push(t)},n.prototype.remove=function(t,e,r){s(this.cells[Math.floor(e/this.res)][Math.floor(r/this.res)],t)};var o=function(t,e,r){var i=document.getElementById(t).getContext("2d");e&&(i.canvas.width=e),r&&(i.canvas.height=r),this.getContext2D=function(){return i},this.redraw=function(){return console.log("Override redraw method"),this}},h=function(t,e,r,i,s,n){this.u=t,this.m=e;var o=this.r();this.x=0,r<o?this.x=o:r>t.w-o?this.x=t.w-o:this.x=r,this.y=0,i<o?this.y=o:i>t.h-o?this.y=t.h-o:this.y=i,this.vx=s,this.vy=n};h.prototype.observe=function(){this.fx=0,this.fy=0;for(var t=0;t<this.u.ps.length;t++){var e=this.u.ps[t];if(this!=e){var r=this.d(e);r*=r*r,this.fx+=.01*(e.x-this.x)*this.m*e.m/r,this.fy+=.01*(e.y-this.y)*this.m*e.m/r}}},h.prototype.d=function(t){var e=t.x-this.x,r=t.y-this.y;return Math.sqrt(e*e+r*r)},h.prototype.r=function(){return Math.sqrt(this.m/Math.PI)},h.prototype.change=function(){var t=this.fx/this.m,e=this.fy/this.m;this.vx+=t*this.u.timeStepMs,this.vy+=e*this.u.timeStepMs,this.x+=this.vx*this.u.timeStepMs,this.y+=this.vy*this.u.timeStepMs,this.x<0&&(this.x=this.u.w),this.y<0&&(this.y=this.u.h),this.x>this.u.w&&(this.x=0),this.y>this.u.h&&(this.y=0)};var l=function(t,e,r){this.w=t,this.h=e,this.timeStepMs=r,this.ps=[]};l.prototype.fillRandomly=function(t,e,r,i){this.ps=[];for(var s=0;s<t;s++){var n=r+Math.random()*(i-r),o=2*Math.random()*Math.PI;this.ps.push(new h(this,e,this.w*Math.random(),this.h*Math.random(),n*Math.cos(o),n*Math.sin(o)))}return this},l.prototype.step=function(){var t;for(t=0;t<this.ps.length;t++)this.ps[t].observe();for(t=0;t<this.ps.length;t++)this.ps[t].change();for(var e=this.findCollision();null!==e;)this.ps.push(this.aggregate(e)),s(this.ps,e[0]),s(this.ps,e[1]),e=this.findCollision()},l.prototype.findCollision=function(){for(var t=0;t<this.ps.length;t++)for(var e=this.ps[t],r=t+1;r<this.ps.length;r++){var i=this.ps[r];if(!(e.d(i)>e.r()+i.r()))return[e,i]}return null},l.prototype.aggregate=function(t){var e=t[0],r=t[1],i=e.m+r.m;return new h(this,i,(e.x*e.m+r.x*r.m)/i,(e.y*e.m+r.y*r.m)/i,(e.vx*e.m+r.vx*r.m)/i,(e.vy*e.m+r.vy*r.m)/i)},l.prototype.start=function(t,e){var r=0,i=this;return function s(){i.step(),e.redraw(),t>0&&r++>t||setTimeout(s,0)}(),this};var f=function(t,e){var r=document.getElementById(div),i=r.offsetWidth,s=r.offsetHeight,n=new l(i,s,10).fillRandomly(1e3,.5,0,.1),o=new CanPl.CanvasPlus(canvas,i,s),h=o.getContext2D();h.fillStyle="#000000",h.fillRect(0,0,i,s),o.redraw=function(){h.fillStyle="rgba(0,0,0,0.05)",h.fillRect(0,0,i,s);for(var t=0;t<n.ps.length;t++){var e=n.ps[t],r=e.m/500;h.fillStyle="rgb(255,255,"+Math.floor(255*(1-r))+")",h.beginPath(),h.arc(e.x,e.y,e.r(),0,2*Math.PI),h.closePath(),h.fill()}h.fillStyle="rgb(200,200,200)",h.fillRect(0,0,65,13),h.fillStyle="rgb(0,0,0)",h.fillText(n.ps.length+" planets",2,10)},n.start(-1,o)}}])}));