!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.vectag=e():t.vectag=e()}(window,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="build/",i(i.s=0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){"use strict";i.r(e),i.d(e,"planets",(function(){return y})),i.d(e,"gameOfLife",(function(){return b}));var n=function(t,e){var i=t.indexOf(e);i>-1?t.splice(i,1):console.log("Impossible to remove element not present in array.")};function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.res=n,this.lengthX=Math.floor(e/n+1),this.lengthY=Math.floor(i/n+1),this.cells=[];for(var r=0;r<this.lengthX;r++){this.cells[r]=[];for(var s=0;s<this.lengthY;s++)this.cells[r][s]=[]}}var e,i,s;return e=t,(i=[{key:"get",value:function(t,e,i,n){for(var r=[],s=Math.floor(t/this.res);s<Math.floor(i/this.res+1);s++)if(!(s<0||s>=this.lengthX))for(var h=Math.floor(e/this.res);h<Math.floor(n/this.res+1);h++)h<0||h>=this.lengthY||r.push.apply(r,this.cells[s][h]);return r}},{key:"add",value:function(t,e,i){return this.cells[Math.floor(e/this.res)][Math.floor(i/this.res)].push(t)}},{key:"remove",value:function(t,e,i){n(this.cells[Math.floor(e/this.res)][Math.floor(i/this.res)],t)}},{key:"move",value:function(t,e,i,r,s){var h=Math.floor(e/this.res),o=Math.floor(i/this.res),a=Math.floor(r/this.res),u=Math.floor(s/this.res);if(h!=a||o!=u)return n(this.cells[h][o],t),this.cells[a][u].push(t)}}])&&r(e.prototype,i),s&&r(e,s),t}();function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=function(){function t(e,i,n,r,s,h){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.u=e,this.m=i;var o=this.r();this.x=n<o?o:n>e.w-o?e.w-o:n,this.y=r<o?o:r>e.h-o?e.h-o:r,this.vx=s,this.vy=h}var e,i,n;return e=t,(i=[{key:"observe",value:function(){this.fx=0,this.fy=0;for(var t=0;t<this.u.ps.length;t++){var e=this.u.ps[t];if(this!=e){var i=this.d(e);0!==i&&(i*=i*i,this.fx+=.01*(e.x-this.x)*this.m*e.m/i,this.fy+=.01*(e.y-this.y)*this.m*e.m/i)}}}},{key:"d",value:function(t){var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)}},{key:"r",value:function(){return Math.pow(this.m/Math.PI,.5)}},{key:"change",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,n=this.fx/this.m,r=this.fy/this.m;if(this.vx+=n*i,this.vy+=r*i,e>0){var s=Math.sqrt(this.vx*this.vx+this.vy*this.vy);s>e&&(this.vx=e*this.vx/s,this.vy=e*this.vy/s)}var h=this.x+this.vx*i,o=this.y+this.vy*i;if(t){var a=this.r(),u=1;h<a&&(h=a,this.vx=-this.vx*u),o<a&&(o=a,this.vy=-this.vy*u),h>this.u.w-a&&(h=this.u.w-a,this.vx=-this.vx*u),o>this.u.h-a&&(o=this.u.h-a,this.vy=-this.vy*u)}else h<0&&(h=this.u.w),o<0&&(o=this.u.h),h>this.u.w&&(h=0),o>this.u.h&&(o=0);this.u.move(this,h,o)}}])&&h(e.prototype,i),n&&h(e,n),t}();function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.min(e,i)/100;a(this,t),this.w=e,this.h=i,this.ps=[],this.grid=new s(e,i,n)}var e,i,r;return e=t,(i=[{key:"m",value:function(){for(var t=0,e=0;e<this.ps.length;e++)t+=this.ps[e].m;return t}},{key:"createPlanet",value:function(t,e,i,n,r){var s=new o(this,t,e,i,n,r);this.add(s)}},{key:"add",value:function(t){t.u=this,this.ps.push(t),this.grid.add(t,t.x,t.y)}},{key:"remove",value:function(t){t.u=null,n(this.ps,t),this.grid.remove(t,t.x,t.y)}},{key:"move",value:function(t,e,i){this.grid.move(t,t.x,t.y,e,i),t.x=e,t.y=i}},{key:"aggregate",value:function(t,e){var i=t.m+e.m,n=this.createPlanet(i,(t.x*t.m+e.x*e.m)/i,(t.y*t.m+e.y*e.m)/i,(t.vx*t.m+e.vx*e.m)/i,(t.vy*t.m+e.vy*e.m)/i);return this.remove(t),this.remove(e),n}},{key:"findCollision",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=0;e<this.ps.length;e++)for(var i=this.ps[e],n=2*i.r(),r=this.grid.get(i.x-n,i.y-n,i.x+n,i.y+n),s=0;s<r.length;s++){var h=r[s];if(i!=h){var o=i.d(h),a=(i.r()+h.r())*t;if(!(o>a))return[i,h]}}return null}},{key:"step",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;for(t=0;t<this.ps.length;t++)this.ps[t].observe();for(t=0;t<this.ps.length;t++)this.ps[t].change(e,i,r);for(var s=this.findCollision(n);null!==s;)this.aggregate(s[0],s[1]),s=this.findCollision(n)}}])&&u(e.prototype,i),r&&u(e,r),t}();function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var f=function(){function t(){var e=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"vadiv",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"vacanvas",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;v(this,t);var h=document.getElementById(i);this.w=h.offsetWidth,this.h=h.offsetHeight,this.canvas=document.createElement("canvas"),this.canvas.id=n,this.canvas.width=this.w,this.canvas.height=this.h,h.appendChild(this.canvas),this.c2d=this.canvas.getContext("2d"),this.center=r||{x:.5*this.w,y:.5*this.h},this.ps=s;var o=!1;this.canvas.addEventListener("mousedown",(function(t){o=!0})),this.canvas.addEventListener("mousemove",(function(t){o&&e.pan(-t.movementX*e.ps,t.movementY*e.ps)})),this.canvas.addEventListener("mouseup",(function(t){o=!1}));var a=1.5;this.canvas.addEventListener("wheel",(function(t){var i=t.deltaY>0?a:1/a;e.zoom(i,e.pixToGeoX(t.offsetX),e.pixToGeoY(t.offsetY))}))}var e,i,n;return e=t,(i=[{key:"redraw",value:function(){return console.log("Override redraw method"),this}},{key:"geoToPixX",value:function(t){return(t-this.center.x)/this.ps+.5*this.w}},{key:"geoToPixY",value:function(t){return-(t-this.center.y)/this.ps+.5*this.h}},{key:"pixToGeoX",value:function(t){return(t-.5*this.w)*this.ps+this.center.x}},{key:"pixToGeoY",value:function(t){return-(t-.5*this.h)*this.ps+this.center.y}},{key:"pan",value:function(t,e){this.center.x+=t,this.center.y+=e,this.redraw()}},{key:"zoom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.center.x,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.center.y;this.ps*=t,this.center.x+=(e-this.center.x)*(1-t),this.center.y+=(i-this.center.y)*(1-t),this.redraw()}}])&&c(e.prototype,i),n&&c(e,n),t}();function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(e=e||{}).divId=e.divId||"vadiv";var i=document.getElementById(e.divId);this.w=i.offsetWidth,this.h=i.offsetHeight,this.cplus=new f(e.divId,"vacanvas"),this.cplus.c2d.fillStyle="black",this.cplus.c2d.fillRect(0,0,this.w,this.h);var n=this;this.cplus.redraw=function(){this.c2d.fillStyle="rgba(0,0,0,0.05)",this.c2d.fillRect(0,0,n.w,n.h);for(var t=0;t<n.uni.ps.length;t++){var e=n.uni.ps[t],i=e.m/n.uni.m();this.c2d.fillStyle="rgb(255,255,"+Math.floor(255*(1-i))+")",this.c2d.beginPath(),this.c2d.arc(this.geoToPixX(e.x),this.geoToPixY(e.y),e.r()/this.ps,0,2*Math.PI),this.c2d.closePath(),this.c2d.fill()}this.c2d.fillStyle="rgb(200,200,200)",this.c2d.fillRect(0,0,65,13),this.c2d.fillStyle="rgb(0,0,0)",this.c2d.fillText(n.uni.ps.length+" planets",2,10),this.c2d.strokeStyle="darkgray",this.c2d.beginPath(),this.c2d.rect(this.geoToPixX(0),this.geoToPixY(this.h),n.w/this.ps,n.h/this.ps),this.c2d.stroke()},this.uni=new l(this.w,this.h)}var e,i,n;return e=t,(i=[{key:"initRandom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.1;this.uni.ps=[];for(var r=0;r<t;r++){var s=i+Math.random()*(n-i),h=2*Math.random()*Math.PI;this.uni.createPlanet(e,this.w*Math.random(),this.h*Math.random(),s*Math.cos(h),s*Math.sin(h))}return this}},{key:"initBigBang",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.35,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.7,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100;this.uni.ps=[];for(var s=.5*this.w,h=.5*this.h,o=2*Math.PI/t,a=0;a<t;a++){var u=a*o,l=r*Math.random(),v=s+l*Math.cos(u),c=h+l*Math.sin(u),f=i+Math.random()*(n-i),d=u+2*(Math.random()-.5)*2*Math.PI/3,p=f*Math.cos(d),y=f*Math.sin(d);this.uni.createPlanet(e,v,c,p,y)}return this}},{key:"start",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,s=0,h=this,o=function o(){h.uni.step(t,e,i,n),h.cplus.redraw(),r>0&&s++>r||setTimeout(o,0)};o()}},{key:"stop",value:function(){}}])&&d(e.prototype,i),n&&d(e,n),t}(),y=function(t){return new p(t)};function g(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var m=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.w=e,this.h=i,this.population=[],this.populationI={}}var e,i,n;return e=t,n=[{key:"getCellSurrounding",value:function(t,e){var i=0===t.x?e.w-1:t.x-1,n=t.x===e.w-1?0:t.x+1,r=0===t.y?e.h-1:t.y-1,s=t.y===e.h-1?0:t.y+1;return[{x:i,y:r},{x:i,y:t.y},{x:i,y:s},{x:t.x,y:r},{x:t.x,y:s},{x:n,y:r},{x:n,y:t.y},{x:n,y:s}]}}],(i=[{key:"add",value:function(t,e){var i=t+"_"+e;if(this.populationI[i])return null;var n={x:t,y:e,nb:0};return this.population.push(n),this.populationI[i]=n,n}},{key:"step",value:function(){var e,i,n,r,s,h,o,a={};for(e=0;e<this.population.length;e++){var u=t.getCellSurrounding(this.population[e],this);for(i=0;i<u.length;i++)(h=a[o=(s=u[i]).x+"_"+s.y])?h.nb++:(s.nb=1,a[o]=s)}var l=[],v={};for(e=0;e<this.population.length;e++)(r=a[o=(n=this.population[e]).x+"_"+n.y])&&(r.nb<2||r.nb>3||(l.push(n),v[o]=n));this.population=l,this.populationI=v;var c=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(t[i]);return e}(a);for(e=0;e<c.length;e++)3===(s=c[e]).nb&&(o=s.x+"_"+s.y,(n=this.populationI[o])||(this.population.push(s),this.populationI[o]=s));return this}},{key:"start",value:function(t,e,i){var n=0,r=this;return function s(){r.step(),i.redraw(),t>0&&n++>t||setTimeout(s,e)}(),this}}])&&g(e.prototype,i),n&&g(e,n),t}();function x(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var w=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),(e=e||{}).divId=e.divId||"vadiv";var i=document.getElementById(e.divId);this.w=i.offsetWidth,this.h=i.offsetHeight,this.cplus=new f(e.divId,"vacanvas");var n=this;this.cplus.redraw=function(){this.c2d.clearRect(0,0,n.w,n.h),this.c2d.fillStyle="#0000FF";for(var t=0;t<n.uni.population.length;t++){var e=n.uni.population[t];this.c2d.fillRect(this.geoToPixX(e.x),this.geoToPixY(e.y),1/this.ps,1/this.ps)}this.c2d.strokeStyle="lightgray",this.c2d.beginPath(),this.c2d.rect(this.geoToPixX(0),this.geoToPixY(this.h),n.w/this.ps,n.h/this.ps),this.c2d.stroke()},this.uni=new m(this.w,this.h)}var e,i,n;return e=t,(i=[{key:"initRandom",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.05,e=0,i=this.uni.w*this.uni.h*t;e<i;){var n=Math.round(this.uni.w*Math.random()),r=Math.round(this.uni.h*Math.random()),s=this.uni.add(n,r);s&&e++}return this}},{key:"start",value:function(){this.uni.start(-1,0,this.cplus)}}])&&x(e.prototype,i),n&&x(e,n),t}(),b=function(t){return new w(t)}}])}));